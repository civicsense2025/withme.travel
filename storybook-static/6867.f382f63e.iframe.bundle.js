"use strict";(self.webpackChunkwithme_travel=self.webpackChunkwithme_travel||[]).push([[2402,3909,6867],{"./components/research/ResearchProvider.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{T:()=>useResearch});__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js");var react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js");__webpack_require__("./components/ui/use-toast.ts");const FORM_FIELD_TYPES_TEXT="text",FORM_FIELD_TYPES_SELECT="select",FORM_FIELD_TYPES_RADIO="radio",FORM_FIELD_TYPES_CHECKBOX="checkbox",FORM_FIELD_TYPES_RATING="rating",FORM_FIELD_TYPES_NUMBER="number",FORM_FIELD_TYPES_TEXTAREA="textarea",FORM_FIELD_TYPES_WELCOME="welcome",FORM_FIELD_TYPES_COMPLETION="completion",FORM_TYPES_SURVEY="survey",FORM_TYPES_FEEDBACK="feedback";(new Date).toISOString(),(new Date).toISOString(),(new Date).toISOString(),(new Date).toISOString(),(new Date).toISOString(),(new Date).toISOString();__webpack_require__("./utils/supabase/client.ts"),__webpack_require__("./node_modules/console-browserify/index.js");__webpack_require__("./node_modules/console-browserify/index.js");const ResearchContext=(0,react.createContext)(void 0);function useResearch(){const context=(0,react.useContext)(ResearchContext);if(void 0===context)throw new Error("useResearch must be used within a ResearchProvider");return context}},"./components/research/SurveyContainer.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{e:()=>SurveyContainer});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),use_toast=__webpack_require__("./components/ui/use-toast.ts"),ui_button=__webpack_require__("./components/ui/button.tsx"),card=__webpack_require__("./components/ui/card.tsx"),progress=__webpack_require__("./components/ui/progress.tsx"),QuestionRenderer=__webpack_require__("./components/research/QuestionRenderer.tsx"),ResearchProvider=__webpack_require__("./components/research/ResearchProvider.tsx");const RESEARCH_EVENT_TYPES={SESSION_STARTED:"session_started",SESSION_COMPLETED:"session_completed",SURVEY_STARTED:"survey_started",SURVEY_STEP_COMPLETED:"survey_step_completed",SURVEY_COMPLETED:"survey_completed",SURVEY_ABANDONED:"survey_abandoned",SURVEY_VIEWED:"survey_viewed",MILESTONE_REACHED:"milestone_reached",TRIP_CREATED:"trip_created",TRIP_EDITED:"trip_edited",TRIP_SHARED:"trip_shared",ITINERARY_ITEM_ADDED:"itinerary_item_added",ITINERARY_ITEM_EDITED:"itinerary_item_edited",ITINERARY_ITEM_REMOVED:"itinerary_item_removed",FEATURE_USED:"feature_used",ERROR_ENCOUNTERED:"error_encountered"};var AnimatePresence=__webpack_require__("./node_modules/framer-motion/dist/es/components/AnimatePresence/index.mjs"),proxy=__webpack_require__("./node_modules/framer-motion/dist/es/render/components/motion/proxy.mjs"),console=__webpack_require__("./node_modules/console-browserify/index.js");function SurveyContainer({survey,onComplete}){var _getCurrentResponse;const{toast}=(0,use_toast.dj)(),{saveResponses,session,createSession}=(0,ResearchProvider.T)(),{track,eventTypes}=function useResearchTracking(){const{trackEvent,session}=(0,ResearchProvider.T)();return{track:async(eventType,details,milestone)=>trackEvent(eventType,details,milestone),trackMilestone:async(milestone,details)=>trackEvent(RESEARCH_EVENT_TYPES.MILESTONE_REACHED,{...details,milestone},milestone),trackFeatureUsage:async(featureName,details)=>trackEvent(RESEARCH_EVENT_TYPES.FEATURE_USED,{...details,feature:featureName}),trackError:async(errorMessage,details)=>trackEvent(RESEARCH_EVENT_TYPES.ERROR_ENCOUNTERED,{...details,error:errorMessage}),session,eventTypes:RESEARCH_EVENT_TYPES}}(),[currentMilestoneIndex,setCurrentMilestoneIndex]=(0,react.useState)(0),[currentQuestionIndex,setCurrentQuestionIndex]=(0,react.useState)(0),[responses,setResponses]=(0,react.useState)([]),[isSubmitting,setIsSubmitting]=(0,react.useState)(!1);(0,react.useEffect)((()=>{(async()=>{if(!session)try{await createSession()}catch(error){console.error("Failed to create session:",error),toast({title:"Error",description:"Failed to initialize session. Your responses may not be saved.",variant:"destructive"})}})()}),[session,createSession,toast]),(0,react.useEffect)((()=>(track(eventTypes.SURVEY_STARTED,{survey_id:survey.id,survey_name:survey.name}),()=>{responses.length>0&&responses.length<survey.fields.length&&track(eventTypes.SURVEY_ABANDONED,{survey_id:survey.id,completed_questions:responses.length,total_questions:survey.fields.length})})),[]);const currentMilestone=survey.milestones[currentMilestoneIndex],milestoneQuestions=survey.fields.filter((field=>field.milestone===currentMilestone)),currentQuestion=milestoneQuestions[currentQuestionIndex],totalQuestions=survey.fields.length,completedQuestions=responses.length,progressPercentage=Math.round(completedQuestions/totalQuestions*100),getCurrentResponse=()=>responses.find((r=>r.fieldId===currentQuestion.id)),handleSubmit=async()=>{setIsSubmitting(!0);try{await saveResponses(survey.id,responses.map((r=>({id:r.fieldId,value:r.value})))),await track(eventTypes.SURVEY_COMPLETED,{survey_id:survey.id,survey_name:survey.name,responses_count:responses.length}),toast({title:"Survey Completed",description:"Your responses have been submitted successfully."}),onComplete()}catch(error){console.error("Error submitting responses:",error),toast({title:"Submission Error",description:"There was a problem submitting your responses. Please try again.",variant:"destructive"}),await track(eventTypes.ERROR_ENCOUNTERED,{survey_id:survey.id,error:error instanceof Error?error.message:"Unknown error"})}finally{setIsSubmitting(!1)}},isFinalQuestion=currentMilestoneIndex===survey.milestones.length-1&&currentQuestionIndex===milestoneQuestions.length-1,getMilestoneDisplayName=milestone=>milestone.replace(/_/g," ").split(" ").map((word=>word.charAt(0).toUpperCase()+word.slice(1))).join(" ");return(0,jsx_runtime.jsxs)("div",{className:"p-6 md:p-8",children:[(0,jsx_runtime.jsxs)("div",{className:"mb-8",children:[(0,jsx_runtime.jsx)("div",{className:"flex justify-between mb-2",children:survey.milestones.map(((milestone,index)=>(0,jsx_runtime.jsx)("div",{className:"text-xs font-medium "+(index<=currentMilestoneIndex?"text-primary":"text-muted-foreground"),children:getMilestoneDisplayName(milestone)},milestone)))}),(0,jsx_runtime.jsx)(progress.k,{value:progressPercentage,className:"h-2"}),(0,jsx_runtime.jsx)("div",{className:"text-xs text-muted-foreground mt-2 text-right",children:`${completedQuestions} of ${totalQuestions} questions completed`})]}),(0,jsx_runtime.jsx)(card.Zp,{className:"p-6 mb-6",children:(0,jsx_runtime.jsx)(AnimatePresence.N,{mode:"wait",children:(0,jsx_runtime.jsx)(proxy.P.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:(0,jsx_runtime.jsx)(QuestionRenderer.c,{question:currentQuestion,response:null===(_getCurrentResponse=getCurrentResponse())||void 0===_getCurrentResponse?void 0:_getCurrentResponse.value,onChange:value=>{const responseIndex=responses.findIndex((r=>r.fieldId===currentQuestion.id));if(responseIndex>=0){const updatedResponses=[...responses];updatedResponses[responseIndex]={fieldId:currentQuestion.id,value},setResponses(updatedResponses)}else setResponses([...responses,{fieldId:currentQuestion.id,value}])}})},currentQuestion.id)})}),(0,jsx_runtime.jsxs)("div",{className:"flex justify-between",children:[(0,jsx_runtime.jsx)(ui_button.$,{variant:"outline",onClick:()=>{if(currentQuestionIndex>0)setCurrentQuestionIndex(currentQuestionIndex-1);else if(currentMilestoneIndex>0){const previousMilestone=survey.milestones[currentMilestoneIndex-1],previousMilestoneQuestions=survey.fields.filter((field=>field.milestone===previousMilestone));setCurrentMilestoneIndex(currentMilestoneIndex-1),setCurrentQuestionIndex(previousMilestoneQuestions.length-1)}},disabled:0===currentMilestoneIndex&&0===currentQuestionIndex,children:"Previous"}),(0,jsx_runtime.jsx)(ui_button.$,{onClick:async()=>{currentQuestionIndex<milestoneQuestions.length-1?(setCurrentQuestionIndex(currentQuestionIndex+1),await track(eventTypes.SURVEY_STEP_COMPLETED,{survey_id:survey.id,question_id:currentQuestion.id,milestone:currentMilestone})):currentMilestoneIndex<survey.milestones.length-1?(await track(eventTypes.MILESTONE_REACHED,{milestone:currentMilestone,survey_id:survey.id},currentMilestone),setCurrentMilestoneIndex(currentMilestoneIndex+1),setCurrentQuestionIndex(0)):handleSubmit()},disabled:!(()=>{if(!currentQuestion.required)return!0;const response=getCurrentResponse();return!!response&&(Array.isArray(response.value)?response.value.length>0:"string"==typeof response.value?response.value.trim().length>0:void 0!==response.value&&null!==response.value)})()||isSubmitting,children:isSubmitting?"Submitting...":isFinalQuestion?"Submit":"Next"})]})]})}SurveyContainer.__docgenInfo={description:"SurveyContainer component that orchestrates the multi-milestone survey experience\nHandles progress tracking, navigation, validation, and response submission",methods:[],displayName:"SurveyContainer",props:{survey:{required:!0,tsType:{name:"Survey"},description:""},onComplete:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}}},"./components/ui/button.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{$:()=>Button});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),_lib_utils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./lib/utils.ts"),_spinner__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./components/ui/spinner.tsx"),class_variance_authority__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/class-variance-authority/dist/index.mjs"),_radix_ui_react_slot__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@radix-ui/react-slot/dist/index.mjs");const buttonVariants=(0,class_variance_authority__WEBPACK_IMPORTED_MODULE_4__.F)("inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{primary:"bg-primary text-primary-foreground shadow hover:bg-primary/90",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",accent:"bg-accent text-accent-foreground shadow-sm hover:bg-accent/90",outline:"border-2 border-primary bg-transparent text-primary hover:bg-muted",ghost:"bg-transparent text-muted-foreground hover:bg-muted hover:text-foreground"},size:{sm:"h-9 px-3 text-sm rounded-md",md:"h-10 px-4 py-2 rounded-md",lg:"h-12 px-6 py-3 text-lg rounded-lg"},width:{auto:"",full:"w-full"}},defaultVariants:{variant:"primary",size:"md",width:"auto"}}),Button=react__WEBPACK_IMPORTED_MODULE_1__.forwardRef((({className,variant,size,width,children,disabled,leftIcon,rightIcon,loading=!1,loadingText,ariaDescription,asChild=!1,...props},ref)=>{const Comp=asChild?_radix_ui_react_slot__WEBPACK_IMPORTED_MODULE_5__.DX:"button";return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Comp,{className:(0,_lib_utils__WEBPACK_IMPORTED_MODULE_2__.cn)(buttonVariants({variant,size,width}),className),disabled:asChild?void 0:disabled||loading,"aria-disabled":disabled||loading,"aria-description":ariaDescription,ref,...props,children:loading?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_spinner__WEBPACK_IMPORTED_MODULE_3__.y,{size:"sm",className:"mr-2"}),loadingText||"Loading..."]}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment,{children:[leftIcon&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:"mr-2 inline-flex items-center",children:leftIcon}),children,rightIcon&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:"ml-2 inline-flex items-center",children:rightIcon})]})})}));Button.displayName="Button",Button.__docgenInfo={description:'Button component with multiple variants and sizes, respecting color themes.\nNow supports loading and improved hover states.\nSupports asChild pattern for custom elements.\n\n@example\n<Button variant="primary" size="md" loading loadingText="Submitting...">\n  Submit\n</Button>\n\n<Button asChild>\n  <Link href="/foo">Go to Foo</Link>\n</Button>',methods:[],displayName:"Button",props:{ariaDescription:{required:!1,tsType:{name:"string"},description:"Optional additional description for screen readers"},leftIcon:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"Optional leading icon"},rightIcon:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"Optional trailing icon"},loading:{required:!1,tsType:{name:"boolean"},description:"Show a loading spinner and disable the button",defaultValue:{value:"false",computed:!1}},loadingText:{required:!1,tsType:{name:"string"},description:"Text to show when loading (replaces children)"},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"The content of the button"},asChild:{required:!1,tsType:{name:"boolean"},description:"Render as child (for custom elements like Link)",defaultValue:{value:"false",computed:!1}}},composes:["VariantProps"]}},"./components/ui/progress.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{k:()=>Progress});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),_radix_ui_react_progress__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@radix-ui/react-progress/dist/index.mjs"),_lib_utils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./lib/utils.ts");const Progress=react__WEBPACK_IMPORTED_MODULE_1__.forwardRef((({className,value,...props},ref)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_radix_ui_react_progress__WEBPACK_IMPORTED_MODULE_3__.bL,{ref,className:(0,_lib_utils__WEBPACK_IMPORTED_MODULE_2__.cn)("relative h-2 w-full overflow-hidden rounded-full bg-secondary",className),...props,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_radix_ui_react_progress__WEBPACK_IMPORTED_MODULE_3__.C1,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(value||0)}%)`}})})));Progress.displayName=_radix_ui_react_progress__WEBPACK_IMPORTED_MODULE_3__.bL.displayName,Progress.__docgenInfo={description:"",methods:[]}},"./components/ui/spinner.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{y:()=>Spinner});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),_barrel_optimize_names_Loader2_lucide_react__WEBPACK_IMPORTED_MODULE_3__=(__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),__webpack_require__("./node_modules/lucide-react/dist/esm/icons/loader-circle.js")),_lib_utils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./lib/utils.ts");function Spinner({size="md",className}){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_barrel_optimize_names_Loader2_lucide_react__WEBPACK_IMPORTED_MODULE_3__.A,{className:(0,_lib_utils__WEBPACK_IMPORTED_MODULE_2__.cn)("animate-spin text-primary",{sm:"h-4 w-4",md:"h-6 w-6",lg:"h-8 w-8"}[size],className)})}Spinner.__docgenInfo={description:"Simple spinner component for loading states",methods:[],displayName:"Spinner",props:{size:{required:!1,tsType:{name:"union",raw:"'sm' | 'md' | 'lg'",elements:[{name:"literal",value:"'sm'"},{name:"literal",value:"'md'"},{name:"literal",value:"'lg'"}]},description:"Optional size to render",defaultValue:{value:"'md'",computed:!1}},className:{required:!1,tsType:{name:"string"},description:"Optional additional class names"}}}},"./components/ui/use-toast.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{dj:()=>useToast,oR:()=>toast});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/index.js");let count=0;const toastTimeouts=new Map,addToRemoveQueue=toastId=>{if(toastTimeouts.has(toastId))return;const timeout=setTimeout((()=>{toastTimeouts.delete(toastId),dispatch({type:"REMOVE_TOAST",toastId})}),1e6);toastTimeouts.set(toastId,timeout)},reducer=(state,action)=>{switch(action.type){case"ADD_TOAST":return{...state,toasts:[action.toast,...state.toasts].slice(0,1)};case"UPDATE_TOAST":return{...state,toasts:state.toasts.map((t=>t.id===action.toast.id?{...t,...action.toast}:t))};case"DISMISS_TOAST":{const{toastId}=action;return toastId?addToRemoveQueue(toastId):state.toasts.forEach((toast=>addToRemoveQueue(toast.id))),{...state,toasts:state.toasts.map((t=>t.id===toastId||void 0===toastId?{...t,open:!1}:t))}}case"REMOVE_TOAST":return void 0===action.toastId?{...state,toasts:[]}:{...state,toasts:state.toasts.filter((t=>t.id!==action.toastId))}}},listeners=[];let memoryState={toasts:[]};function dispatch(action){memoryState=reducer(memoryState,action),listeners.forEach((listener=>listener(memoryState)))}function toast({...props}){const id=function genId(){return count=(count+1)%Number.MAX_SAFE_INTEGER,count.toString()}(),dismiss=()=>dispatch({type:"DISMISS_TOAST",toastId:id});return dispatch({type:"ADD_TOAST",toast:{...props,id,open:!0,onOpenChange:open=>{open||dismiss()}}}),{id,dismiss,update:props=>dispatch({type:"UPDATE_TOAST",toast:{...props,id}})}}function useToast(){const[state,setState]=react__WEBPACK_IMPORTED_MODULE_0__.useState(memoryState);return react__WEBPACK_IMPORTED_MODULE_0__.useEffect((()=>(listeners.push(setState),()=>{const index=listeners.indexOf(setState);index>-1&&listeners.splice(index,1)})),[state]),{...state,toast,dismiss:toastId=>dispatch({type:"DISMISS_TOAST",toastId})}}},"./utils/supabase/browser-client.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{getBrowserClient:()=>getBrowserClient,resetBrowserClient:()=>resetBrowserClient});var _supabase_ssr__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@supabase/ssr/dist/module/index.js"),console=__webpack_require__("./node_modules/console-browserify/index.js");let browserClient=null;function getBrowserClient(){if(browserClient)return browserClient;const supabaseAnonKey="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS1kZW1vIiwicm9sZSI6ImFub24iLCJleHAiOjE5ODM4MTI5OTZ9.CRXP1A7WOeoJeXxjNni43kdQwgnWNReilDMblYTn_I0";return browserClient=(0,_supabase_ssr__WEBPACK_IMPORTED_MODULE_0__.createBrowserClient)("http://localhost:54321",supabaseAnonKey,{global:{headers:{Accept:"application/json"}},auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!1}}),browserClient}function resetBrowserClient(){console.log("[supabase] Resetting browser client singleton"),browserClient=null}},"./utils/supabase/client.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{createClient:()=>createClient,kT:()=>createBrowserClient});var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@supabase/supabase-js/dist/module/index.js");__webpack_require__("./utils/supabase/browser-client.ts");const supabaseUrl="http://localhost:54321",supabaseAnonKey="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS1kZW1vIiwicm9sZSI6ImFub24iLCJleHAiOjE5ODM4MTI5OTZ9.CRXP1A7WOeoJeXxjNni43kdQwgnWNReilDMblYTn_I0";if(!supabaseUrl||!supabaseAnonKey)throw new Error("Missing Supabase environment variables (URL or Anon Key).");let clientSingleton=null;function createClient(){return clientSingleton||(clientSingleton=(0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.UU)(supabaseUrl,supabaseAnonKey),clientSingleton)}function createBrowserClient(){return(0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.UU)(supabaseUrl,supabaseAnonKey)}}}]);