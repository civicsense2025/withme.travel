"use strict";(self.webpackChunkwithme_travel=self.webpackChunkwithme_travel||[]).push([[2402,2893],{"./components/groups/ActivityGeneratorWidget.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{p:()=>ActivityGeneratorWidget});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),lightbulb=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/lightbulb.js"),external_link=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/external-link.js"),x=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/x.js"),layout_grid=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/layout-grid.js"),list=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/list.js"),check=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/check.js"),plus=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/plus.js"),ui_button=__webpack_require__("./components/ui/button.tsx"),card=__webpack_require__("./components/ui/card.tsx"),badge=__webpack_require__("./components/ui/badge.tsx");var browser_client=__webpack_require__("./utils/supabase/browser-client.ts"),console=__webpack_require__("./node_modules/console-browserify/index.js");function ActivityGeneratorWidget({groupId,planId,destinationId,onAddIdea,onClose,isCollapsed=!1,onToggleCollapse}){const[viewType,setViewType]=(0,react.useState)("grid"),{activities,keywords,isLoading,error,fetchActivities}=function useActivitySuggestions(options={}){const[activities,setActivities]=(0,react.useState)([]),[keywords,setKeywords]=(0,react.useState)([]),[isLoading,setIsLoading]=(0,react.useState)(!1),[error,setError]=(0,react.useState)(null),[selectedActivities,setSelectedActivities]=(0,react.useState)([]),fetchActivities=(0,react.useCallback)((async(destinationId,tripId)=>{if(!destinationId){var _options_onError;const error=new Error("Destination ID is required");return setError(error),void(null===(_options_onError=options.onError)||void 0===_options_onError||_options_onError.call(options,error))}setIsLoading(!0),setError(null);try{const response=await fetch("/api/activities/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({destinationId,tripId})});if(!response.ok)throw new Error(`Error ${response.status}: ${response.statusText}`);const data=await response.json();setActivities(data.activities||[]),setKeywords(data.keywords||[])}catch(err){var _options_onError1;const error=err instanceof Error?err:new Error("Failed to fetch activities");setError(error),null===(_options_onError1=options.onError)||void 0===_options_onError1||_options_onError1.call(options,error)}finally{setIsLoading(!1)}}),[options]);return{activities,keywords,isLoading,error,fetchActivities,selectActivity:(0,react.useCallback)((activity=>{setSelectedActivities((prev=>prev.some((item=>item.title===activity.title&&item.category===activity.category))?prev.filter((item=>!(item.title===activity.title&&item.category===activity.category))):[...prev,activity]))}),[]),selectedActivities}}(),[addedIdeas,setAddedIdeas]=(0,react.useState)(new Set),[destination,setDestination]=(0,react.useState)(null),[isAddingIdea,setIsAddingIdea]=(0,react.useState)(!1);(0,react.useEffect)((()=>{destinationId&&async function loadDestination(){try{const supabase=(0,browser_client.getBrowserClient)(),{data,error}=await supabase.from("destinations").select("name, description").eq("id",destinationId).single();if(error)throw error;setDestination(data)}catch(error){console.error("Error loading destination:",error)}}()}),[destinationId]),(0,react.useEffect)((()=>{destinationId&&!isLoading&&0===activities.length&&fetchActivities(destinationId)}),[destinationId,fetchActivities,activities.length,isLoading]);const handleAddIdea=async activity=>{if(!isAddingIdea){setIsAddingIdea(!0);try{const ideaKey=`${activity.title}-${activity.category}`,idea={title:activity.title,description:activity.description,tags:[activity.category.toLowerCase(),activity.activityType.toLowerCase()],metadata:{type:"activity",category:activity.category,activityType:activity.activityType,duration:activity.duration,budgetCategory:activity.budgetCategory}};onAddIdea&&(await onAddIdea(idea),setAddedIdeas((prev=>{const newSet=new Set(prev);return newSet.add(ideaKey),newSet})))}catch(error){console.error("Error adding idea:",error)}finally{setIsAddingIdea(!1)}}},formatDuration=hours=>{const fullHours=Math.floor(hours),minutes=Math.round(60*(hours-fullHours));return 0===fullHours?`${minutes} min`:0===minutes?`${fullHours} hr`:`${fullHours} hr ${minutes} min`};return isCollapsed?(0,jsx_runtime.jsxs)(card.Zp,{className:"w-96 shadow-md",children:[(0,jsx_runtime.jsxs)(card.aR,{className:"pb-2 flex flex-row items-center justify-between",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center",children:[(0,jsx_runtime.jsx)(lightbulb.A,{className:"h-5 w-5 mr-2 text-amber-500"}),(0,jsx_runtime.jsx)(card.ZB,{className:"text-base",children:"Activities Ideas"})]}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-1",children:[(0,jsx_runtime.jsx)(ui_button.$,{variant:"ghost",size:"icon",onClick:onToggleCollapse,children:(0,jsx_runtime.jsx)(external_link.A,{className:"h-4 w-4"})}),onClose&&(0,jsx_runtime.jsx)(ui_button.$,{variant:"ghost",size:"icon",onClick:onClose,children:(0,jsx_runtime.jsx)(x.A,{className:"h-4 w-4"})})]})]}),(0,jsx_runtime.jsx)(card.Wu,{className:"text-sm text-muted-foreground",children:(null==destination?void 0:destination.name)?(0,jsx_runtime.jsxs)("p",{children:["Generate activity ideas for ",destination.name]}):(0,jsx_runtime.jsx)("p",{children:"Generate personalized activity ideas"})}),(0,jsx_runtime.jsx)(card.wL,{children:(0,jsx_runtime.jsxs)(ui_button.$,{variant:"default",size:"sm",className:"w-full",onClick:onToggleCollapse,children:[(0,jsx_runtime.jsx)(lightbulb.A,{className:"mr-2 h-4 w-4"}),"Show Activity Generator"]})})]}):(0,jsx_runtime.jsxs)(card.Zp,{className:"w-full max-w-3xl shadow-md",children:[(0,jsx_runtime.jsxs)(card.aR,{className:"pb-2 flex flex-row items-center justify-between",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center",children:[(0,jsx_runtime.jsx)(lightbulb.A,{className:"h-5 w-5 mr-2 text-amber-500"}),(0,jsx_runtime.jsx)(card.ZB,{className:"text-lg",children:"Activity Ideas Generator"})]}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-1",children:[(0,jsx_runtime.jsx)(ui_button.$,{variant:"ghost",size:"icon",onClick:onToggleCollapse,children:(0,jsx_runtime.jsx)(external_link.A,{className:"h-4 w-4"})}),onClose&&(0,jsx_runtime.jsx)(ui_button.$,{variant:"ghost",size:"icon",onClick:onClose,children:(0,jsx_runtime.jsx)(x.A,{className:"h-4 w-4"})})]})]}),(0,jsx_runtime.jsx)(card.BT,{className:"px-6",children:(null==destination?void 0:destination.name)?(0,jsx_runtime.jsxs)("p",{children:["Generate personalized activity ideas for ",destination.name]}):(0,jsx_runtime.jsx)("p",{children:"Generate personalized activity ideas for your trip"})}),(0,jsx_runtime.jsxs)("div",{className:"px-6 pt-2 flex justify-between items-center",children:[keywords.length>0&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-wrap gap-1",children:[keywords.slice(0,5).map((keyword=>(0,jsx_runtime.jsxs)(badge.E,{variant:"outline",className:"text-xs",children:["#",keyword]},keyword))),keywords.length>5&&(0,jsx_runtime.jsxs)(badge.E,{variant:"outline",className:"text-xs",children:["+",keywords.length-5," more"]})]}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-1 ml-auto",children:[(0,jsx_runtime.jsx)(ui_button.$,{variant:"grid"===viewType?"default":"outline",size:"icon",className:"h-8 w-8",onClick:()=>setViewType("grid"),children:(0,jsx_runtime.jsx)(layout_grid.A,{className:"h-4 w-4"})}),(0,jsx_runtime.jsx)(ui_button.$,{variant:"list"===viewType?"default":"outline",size:"icon",className:"h-8 w-8",onClick:()=>setViewType("list"),children:(0,jsx_runtime.jsx)(list.A,{className:"h-4 w-4"})})]})]}),(0,jsx_runtime.jsx)(card.Wu,{className:"pt-4",children:isLoading?(0,jsx_runtime.jsxs)("div",{className:"flex justify-center items-center py-8",children:[(0,jsx_runtime.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-travel-purple"}),(0,jsx_runtime.jsx)("span",{className:"ml-3",children:"Generating personalized activities..."})]}):error?(0,jsx_runtime.jsxs)("div",{className:"text-center py-4",children:[(0,jsx_runtime.jsxs)("p",{className:"text-red-500 mb-2",children:["Error: ",error.message]}),(0,jsx_runtime.jsx)(ui_button.$,{onClick:()=>fetchActivities(destinationId),children:"Try Again"})]}):0===activities.length?(0,jsx_runtime.jsxs)("div",{className:"text-center py-8 border border-dashed rounded-md",children:[(0,jsx_runtime.jsx)(lightbulb.A,{className:"h-12 w-12 mx-auto text-muted-foreground mb-2 opacity-70"}),(0,jsx_runtime.jsx)("p",{className:"text-muted-foreground mb-4",children:"No activity ideas generated yet"}),(0,jsx_runtime.jsx)(ui_button.$,{onClick:()=>fetchActivities(destinationId),children:"Generate Ideas"})]}):"grid"===viewType?(0,jsx_runtime.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:activities.map(((activity,index)=>{const ideaKey=`${activity.title}-${activity.category}`,isAdded=addedIdeas.has(ideaKey);return(0,jsx_runtime.jsxs)(card.Zp,{className:"overflow-hidden",children:[(0,jsx_runtime.jsxs)(card.aR,{className:"pb-2",children:[(0,jsx_runtime.jsx)(card.ZB,{className:"text-base",children:activity.title}),(0,jsx_runtime.jsxs)(card.BT,{className:"flex items-center text-xs",children:[(0,jsx_runtime.jsx)("span",{children:formatDuration(activity.duration)}),(0,jsx_runtime.jsx)("span",{className:"mx-1",children:"â€¢"}),(0,jsx_runtime.jsx)("span",{children:(categoryValue=activity.budgetCategory,{accommodation:"ðŸ¨ Lodging",transportation:"ðŸš† Transport",food:"ðŸ´ Food",activities:"ðŸŽŸï¸ Activities",shopping:"ðŸ›ï¸ Shopping",other:"ðŸ“Œ Other"}[categoryValue]||"Other")})]})]}),(0,jsx_runtime.jsx)(card.Wu,{className:"text-sm",children:(0,jsx_runtime.jsx)("p",{className:"line-clamp-2",children:activity.description})}),(0,jsx_runtime.jsx)(card.wL,{children:(0,jsx_runtime.jsx)(ui_button.$,{variant:isAdded?"secondary":"default",size:"sm",className:"w-full",onClick:()=>handleAddIdea(activity),disabled:isAddingIdea||isAdded,children:isAdded?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(check.A,{className:"mr-2 h-4 w-4"})," Added to Board"]}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(plus.A,{className:"mr-2 h-4 w-4"})," Add to Board"]})})})]},index);var categoryValue}))}):(0,jsx_runtime.jsx)("div",{className:"space-y-2",children:activities.map(((activity,index)=>{const ideaKey=`${activity.title}-${activity.category}`,isAdded=addedIdeas.has(ideaKey);return(0,jsx_runtime.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-md border hover:bg-muted/50 transition-colors",children:[(0,jsx_runtime.jsxs)("div",{className:"flex-1 min-w-0 mr-4",children:[(0,jsx_runtime.jsx)("h4",{className:"font-medium text-sm truncate",children:activity.title}),(0,jsx_runtime.jsx)("p",{className:"text-xs text-muted-foreground line-clamp-1",children:activity.description})]}),(0,jsx_runtime.jsx)(ui_button.$,{variant:isAdded?"secondary":"default",size:"sm",onClick:()=>handleAddIdea(activity),disabled:isAddingIdea||isAdded,children:isAdded?(0,jsx_runtime.jsx)(check.A,{className:"h-4 w-4"}):(0,jsx_runtime.jsx)(plus.A,{className:"h-4 w-4"})})]},index)}))})}),(0,jsx_runtime.jsx)(card.wL,{className:"flex justify-between",children:(0,jsx_runtime.jsx)(ui_button.$,{variant:"outline",onClick:()=>fetchActivities(destinationId),disabled:isLoading,children:"Generate More Ideas"})})]})}ActivityGeneratorWidget.__docgenInfo={description:"",methods:[],displayName:"ActivityGeneratorWidget",props:{groupId:{required:!0,tsType:{name:"string"},description:""},planId:{required:!0,tsType:{name:"string"},description:""},destinationId:{required:!0,tsType:{name:"string"},description:""},onAddIdea:{required:!1,tsType:{name:"signature",type:"function",raw:"(idea: any) => void",signature:{arguments:[{type:{name:"any"},name:"idea"}],return:{name:"void"}}},description:""},onClose:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},isCollapsed:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},onToggleCollapse:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}}},"./components/ui/badge.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{E:()=>Badge});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),class_variance_authority__WEBPACK_IMPORTED_MODULE_3__=(__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),__webpack_require__("./node_modules/class-variance-authority/dist/index.mjs")),_lib_utils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./lib/utils.ts");const badgeVariants=(0,class_variance_authority__WEBPACK_IMPORTED_MODULE_3__.F)("inline-flex items-center border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground","travel-purple":"border-transparent bg-travel-purple text-travel-purple-foreground","travel-blue":"border-transparent bg-travel-blue text-travel-blue-foreground","travel-pink":"border-transparent bg-travel-pink text-travel-pink-foreground","travel-yellow":"border-transparent bg-travel-yellow text-travel-yellow-foreground","travel-mint":"border-transparent bg-travel-mint text-travel-mint-foreground","travel-peach":"border-transparent bg-travel-peach text-travel-peach-foreground",success:"border-transparent bg-emerald-100 text-emerald-800",warning:"border-transparent bg-amber-100 text-amber-800",info:"border-transparent bg-blue-100 text-blue-800",error:"border-transparent bg-red-100 text-red-800"},radius:{sm:"rounded-sm",md:"rounded-md",lg:"rounded-lg",xl:"rounded-xl",full:"rounded-full",none:"rounded-none"}},defaultVariants:{variant:"default",radius:"full"}});function Badge({className,variant,radius,...props}){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:(0,_lib_utils__WEBPACK_IMPORTED_MODULE_2__.cn)(badgeVariants({variant,radius}),className),...props})}Badge.__docgenInfo={description:'Badge component with design system variants.\n\n@example\n<Badge variant="travel-purple" radius="md">Insider</Badge>',methods:[],displayName:"Badge",composes:["VariantProps"]}},"./utils/supabase/browser-client.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{getBrowserClient:()=>getBrowserClient,resetBrowserClient:()=>resetBrowserClient});var _supabase_ssr__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@supabase/ssr/dist/module/index.js"),console=__webpack_require__("./node_modules/console-browserify/index.js");let browserClient=null;function getBrowserClient(){if(browserClient)return browserClient;const supabaseAnonKey="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS1kZW1vIiwicm9sZSI6ImFub24iLCJleHAiOjE5ODM4MTI5OTZ9.CRXP1A7WOeoJeXxjNni43kdQwgnWNReilDMblYTn_I0";return browserClient=(0,_supabase_ssr__WEBPACK_IMPORTED_MODULE_0__.createBrowserClient)("http://localhost:54321",supabaseAnonKey,{global:{headers:{Accept:"application/json"}},auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!1}}),browserClient}function resetBrowserClient(){console.log("[supabase] Resetting browser client singleton"),browserClient=null}}}]);