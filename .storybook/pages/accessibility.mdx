import { Meta } from '@storybook/blocks';

<Meta title="Design System/Accessibility" />

# Accessibility Guidelines

Accessibility is a core principle of our design system. We strive to create components and patterns that are usable by everyone, regardless of ability or context.

## WCAG Compliance

Our components aim to meet WCAG 2.1 AA standards, which include:

### Perceivable

Information and interface components must be presentable to users in ways they can perceive.

#### Color and Contrast

- Text has a contrast ratio of at least 4.5:1 against its background (3:1 for large text)
- UI components and graphical objects have a contrast ratio of at least 3:1 against adjacent colors
- Color is never used as the only means of conveying information

#### Text Alternatives

- All non-text content has text alternatives (e.g., alt text for images)
- Icons that convey meaning have accessible labels or descriptions
- Complex visualizations have detailed text descriptions

### Operable

User interface components and navigation must be operable by all users.

#### Keyboard Accessibility

- All functionality is operable through a keyboard interface
- No keyboard traps (user can navigate to and from all elements)
- Shortcut keys are configurable and do not conflict with assistive technologies

#### Time and Motion

- Users have sufficient time to read and use content
- Auto-playing content can be paused, stopped, or hidden
- Motion animation triggered by interaction can be disabled

### Understandable

Information and operation of the user interface must be understandable.

#### Readability

- Text is readable and understandable
- Unusual words or technical terms are defined
- Abbreviations are expanded or explained

#### Predictability

- Components operate in predictable ways
- Navigation patterns are consistent throughout the application
- Changes in context are initiated only by user request

### Robust

Content must be robust enough to be interpreted by a wide variety of user agents, including assistive technologies.

#### Compatibility

- Markup is properly nested and well-formed
- ARIA roles, states, and properties are used appropriately
- Components work with current and future assistive technologies

## Component Requirements

Each component in our design system must meet the following accessibility requirements:

### Semantic HTML

- Use appropriate HTML elements (buttons for actions, links for navigation, etc.)
- Use proper heading hierarchy (h1-h6) to structure content
- Use list elements (ul, ol, li) for lists of items

### ARIA Implementation

- Use ARIA roles, states, and properties when HTML semantics are insufficient
- Ensure interactive components have accessible names and descriptions
- Manage focus and communicate state changes appropriately

### Testing Requirements

All components must pass:

1. **Automated tests**

   - Storybook a11y addon tests
   - ESLint jsx-a11y rules

2. **Manual keyboard testing**

   - All functionality can be accessed and operated via keyboard
   - Focus order follows a logical sequence
   - Focus states are visible and clear

3. **Screen reader testing**
   - Components communicate their purpose, state, and changes to screen readers
   - No redundant or unnecessary announcements

## Common Patterns

### Buttons

- Use `<button>` elements for actions
- Include text that clearly indicates the action
- Ensure sufficient touch target size (minimum 44x44px)
- Provide visual feedback for hover, focus, and active states

```jsx
// Good example
<Button aria-label={label ? undefined : "Close dialog"}>
  {label || <CloseIcon />}
</Button>

// Avoid this pattern
<div onClick={handleClick} className="button">
  {label}
</div>
```

### Form Inputs

- Use appropriate form elements (`<input>`, `<select>`, etc.)
- Always pair inputs with labels
- Provide clear error messaging
- Group related inputs with fieldsets and legends

```jsx
// Good example
<div>
  <Label htmlFor="email">Email</Label>
  <Input
    id="email"
    type="email"
    aria-describedby="email-hint email-error"
  />
  {error && <ErrorText id="email-error">{error}</ErrorText>}
  <HintText id="email-hint">We'll never share your email</HintText>
</div>

// Avoid this pattern
<div>
  <input type="email" placeholder="Enter email" />
  <span className="error">{error}</span>
</div>
```

### Modals and Dialogs

- Trap focus within the dialog when open
- Return focus to the triggering element when closed
- Allow closing via Escape key
- Use appropriate ARIA roles and attributes

```jsx
<Dialog
  role="dialog"
  aria-modal="true"
  aria-labelledby="dialog-title"
  aria-describedby="dialog-description"
>
  <DialogTitle id="dialog-title">Confirmation</DialogTitle>
  <DialogContent>
    <p id="dialog-description">Are you sure you want to proceed?</p>
  </DialogContent>
  <DialogActions>
    <Button onClick={onCancel}>Cancel</Button>
    <Button onClick={onConfirm}>Confirm</Button>
  </DialogActions>
</Dialog>
```

### Tooltips and Popovers

- Ensure tooltips are accessible via keyboard
- Make sure they don't disappear too quickly
- Provide proper ARIA attributes to associate with their triggers

```jsx
<Button
  aria-describedby="tooltip-id"
  onMouseEnter={showTooltip}
  onMouseLeave={hideTooltip}
  onFocus={showTooltip}
  onBlur={hideTooltip}
>
  Actions
</Button>
<Tooltip id="tooltip-id" role="tooltip">
  Available actions for this item
</Tooltip>
```

## Testing and Validation

We use a combination of automated and manual testing to ensure accessibility:

- Automated testing with axe-core
- Keyboard navigation testing
- Screen reader testing with VoiceOver (macOS) and NVDA (Windows)
- High contrast mode testing

## Resources

- [WCAG 2.1 Guidelines](https://www.w3.org/TR/WCAG21/)
- [WAI-ARIA Authoring Practices](https://www.w3.org/WAI/ARIA/apg/)
- [Inclusive Components](https://inclusive-components.design/)
- [A11y Project Checklist](https://www.a11yproject.com/checklist/)
